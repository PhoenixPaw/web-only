
## TODO: PHXPW Staking WebApp & Bot — аналитика и управление

### 1. **Бэкенд (бот, API, сервисы)**
- [x] Реализовать API-эндпоинт `/api/user_stats` (или `/api/staking_dashboard`), который по Telegram ID возвращает:
  - [x] Общее количество потраченного TON (total_spent_ton)
  - [x] Баланс PHXPW (phxpw_balance)
  - [x] Курс TON и PHXPW (ton_price, phxpw_price), обновляемый раз в 30 сек
  - [x] Есть ли активный стейкинг (is_staking)
  - [x] Список пулов стейкинга (staking_pools: где, сколько, когда, как анлок, множитель)
  - [x] Количество комиссионных собрано (total_commission_earned)
  - [x] Ранг по верности проекту (loyalty_rank)
  - [x] История операций (tx_history)
  - [x] Доступные опции для создания пулов (staking_options)
- [x] Кэшировать и обновлять курсы TON/PHXPW раз в 30 сек
- [x] Вынести всю бизнес-логику в сервисы (чистый код, SRP)
- [x] Сделать авторизацию по Telegram WebAppData или токену
- [x] Добавить API для проверки прав администратора (/api/check_admin)
- [x] Добавить API для добавления наград в пул (/api/add_reward_request)

### 2. **Фронт (WebApp)**
- [x] После подключения кошелька — отправлять запрос к API и получать всю статистику
- [x] Красиво отображать:
  - [x] Баланс PHXPW и TON
  - [x] Курсы токенов (с автообновлением)
  - [x] Активные стейкинг-пулы (с деталями)
  - [x] Историю операций
  - [x] Ранг, комиссии, статус участия
- [x] UI для создания пулов (выбор срока, суммы, множителя) — с переходом в бота для подтверждения
- [x] Кнопки для перехода в бота (создать пул, застейкать, вывести награду и т.д.)
- [x] (Опционально) — часть управления можно реализовать через WebAppData
- [x] Добавить кнопку "Добавить награды в пул" для админа
- [x] Модальное окно с формой для добавления токенов
- [x] Проверка прав администратора на фронте

### 3. **Бот (Telegram)**
- [x] Использовать тот же сервис/эндпоинт для вывода статистики
- [x] Все действия (создание пулов, стейкинг, награды, розыгрыши) — только через Telegram
- [x] Дублировать всю аналитику, что и на сайте
- [x] Админские функции (создание периодов, управление коэффициентами)
- [x] Проверка прав администратора (только ты можешь добавлять бота в группы)

### 4. **Безопасность и UX**
- [x] Проверить, что все данные видит только владелец (жёсткая привязка к Telegram)
- [x] Не показывать приватные данные другим пользователям
- [x] Логировать все действия для аудита
- [x] Жёсткая привязка к Telegram WebApp (без WebApp — никаких действий)
- [x] Проверка прав админа для критических операций

### 5. **Дополнительные улучшения**
- [x] Улучшить дизайн статистики (графики, анимации)
- [ ] Добавить фильтры для истории операций
- [ ] Реализовать push-уведомления о наградах
- [ ] Добавить экспорт данных в PDF/CSV
- [ ] Реализовать мобильную версию WebApp
- [ ] Добавить мультиязычность (русский/английский)
- [ ] Интеграция с внешними API для курсов валют
- [ ] Система достижений и бейджей
- [ ] Социальные функции (рейтинги, лидерборды)

